# setup and load data
setwd("/Users/ivan/Work_directory/Human-Activity-Recognition/")
library(caret)
train <- read.csv('data/pml-training.csv', stringsAsFactor=F)
# explore data
summary(train)
names(train)
str(train)
dim(train)
# NA percents of each variable
na_train <- sapply(1:length(names(train)), function(i, na_base=c()){
na_col <- mean(is.na(train[i]))
na_base <- c(na_base, na_col)})
names(na_train) <- names(train)
na_train <- sort(na_train,decreasing = T)
na_index <- na_train = T
na_index <- na_train == T
na_index
na_index <- na_train > .5
na_index
train2 <- train[,-na_index]
dim(train2)
nzv <- nearZeroVar(train2,saveMetrics = T)
nzv
training <- train2[,-nzv]
nzv <- nearZeroVar(train2,saveMetrics = F)
training <- train2[,-nzv]
dim(training)
fit<- train(training, method = 'gbm')
fit<- train(classe~., data=training, method = 'gbm')
